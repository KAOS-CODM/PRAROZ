document.addEventListener("DOMContentLoaded",function(){console.log("Script loaded!");let i=window.location.pathname.split("/").pop().replace(".html","");console.log("Detected page:",i),fetch(window.API_BASE_URL+"/api/data/recipes").then(e=>e.json()).then(e=>{console.log("Fetched data:",e);var e=e[i],t=(console.log("Recipes for this page:",e),document.getElementById("recipe-container"));t.innerHTML=e?e.map(e=>{let t=e.image;t.startsWith("https")||(t=window.API_BASE_URL+"/"+t);var n=Array.isArray(e.ingredients)?e.ingredients:e.ingredients.split(",").map(e=>e.trim());return`
                    <a href="recipe-details.html?recipe=${encodeURIComponent(e.name.trim())}" class="recipe-card-link">
                        <div class="recipe-card">
                            <img class="recipe-image" src="${t}"  width="100" onerror="this.onerror=null;this.src='placeholder.jpg' ">
                            <h2 class="recipe-title">${e.name}</h2>
                            <p class="recipe-description">${e.description||"A delicious recipe!"}</p>
                            <div class="recipe-ingredients">
                                <h3>Ingredients</h3>
                                <ul>${n.map(e=>`<li>${e}</li>`).join("")}</ul>
                            </div>
                            <div class="recipe-instructions">
                                <strong>Quick Steps:</strong> ${e.shortInstructions||"Click to view full recipe!"}
                            </div>
                        </div>
                    </a>
                `}).join(""):""}).catch(e=>console.error("Error fetching recipes:",e)),fetch(window.API_BASE_URL+"/api/data/contents").then(e=>(console.log("fetching content"),e.json())).then(e=>{console.log("Fetched data:",e);var t=e[i],n=(console.log("Content for this page:",t),document.getElementById("content"));if(n){n.innerHTML=t?`
            <h2 class="content-title">${t.title}</h2>
            <p class="content-description">${t.description}</p>
            <img class="content-image" src="${t.image}">
            `:"<p>No content found for this category.</p>",e.footer&&(n=document.getElementById("dynamic-footer"))&&(n.innerHTML=`
                    <p>${e.footer.text}</p>
                    <p class="social-icons">
                        <a href="${e.footer.social.facebook}" target="_blank"><i class="fab fa-facebook"></i></a>
                        <a href="${e.footer.social.instagram}" target="_blank"><i class="fab fa-instagram"></i></a>
                        <a href="${e.footer.social.twitter}" target="_blank"><i class="fab fa-twitter"></i></a>
                    </p>
                `);let i=window.location.pathname.split("/").pop().split("?")[0].split("#")[0];fetch(window.API_BASE_URL+"/api/data/contents").then(e=>e.json()).then(e=>{console.log("üìÇ Navbar Data:",e.navbar);let n=document.getElementById("nav-links");n?e.navbar.links.forEach(e=>{console.log(`üîó Adding link: ${e.name} (${e.url})`);var t=document.createElement("li");t.classList.add("active"),e.url===i?t.innerHTML=`<a href="${e.url}" class="active"><i class= "${e.icon}">${e.name}</i></a>`:t.innerHTML=`<a href="${e.url}">${e.name}</i></a>`,n.appendChild(t)}):console.error("‚ùå ERROR: Navbar container not found!")}).catch(e=>console.error("‚ùå ERROR Fetching Navbar:",e))}else console.error("ERROR: #content  NOT found in html")}).catch(e=>console.error("Error fetching content:",e)),console.log("‚úÖ Recipe Details Page Loaded!");let o=new URLSearchParams(window.location.search).get("recipe");console.log("üçΩÔ∏è Selected Recipe:",o),console.log("üîç Extracted Recipe Name from URL:",o),o?fetch(window.API_BASE_URL+"/api/data/recipes").then(e=>e.json()).then(e=>{console.log("üìÇ Fetched Data:",e);let t=null;for(var n in e)if(t=e[n].find(e=>e.name.toLowerCase().trim()===o.toLowerCase().trim()))break;var i;t?(document.getElementById("recipe-details").innerHTML=`
            <h1 class="recipe-title">${t.name}</h1>
            <img class="recipe-image" src="${t.image}" alt="${t.name}">
            <p class="recipe-description">${t.description||"A delicious recipe!"}</p>

            <h2>Ingredients</h2>
            <ul class="recipe-ingredients">
                ${t.ingredients.map(e=>`<li>${e}</li>`).join("")}
            </ul>

            <h2>Instructions</h2>
            <p class="recipe-instructions">${t.instructions}</p>

            ${t.extraContent?`
                <div class="recipe-extra">
                    <h2>Additional Info</h2>
                    <p><strong>Prep Time:</strong> ${t.extraContent.prepTime}</p>
                    <p><strong>Cook Time:</strong> ${t.extraContent.cookTime}</p>
                    <p><strong>Servings:</strong> ${t.extraContent.servings}</p>

                    ${t.extraContent&&t.extraContent.nutrition?`
                    <h2>Nutrition Facts</h2>
                    <ul class="nutrition-list">
                        <li><strong>Calories:</strong> ${t.extraContent.nutrition.calories||"N/A"}</li>
                        <li><strong>Protein:</strong> ${t.extraContent.nutrition.protein||"N/A"}</li>
                        <li><strong>Carbs:</strong> ${t.extraContent.nutrition.carbs||"N/A"}</li>
                        <li><strong>Fat:</strong> ${t.extraContent.nutrition.fat||"N/A"}</li>
                    </ul>
`:"<p>No nutrition data available.</p>"}


                    <h2>Chef's Tips</h2>
                    <p class="chef-tips">${t.extraContent.chefTips}</p>
                </div>
            `:""}
            <p><strong>HEY YOU!</strong>yes you, are you interested in submitting a recipe of your own? Click the button below, and let us know what you have in mind!!!</p>
            <button class="redirect-button">Submit a Recipe</button>
        `,document.querySelector(".redirect-button").addEventListener("click",function(){window.location.href="submission.html"})):(console.error("‚ùå ERROR: Recipe not found in JSON."),(i=document.getElementById("recipe-details"))&&(i.innerHTML="<p>‚ö†Ô∏è Recipe not found.</p>"))}).catch(e=>console.error("‚ùå ERROR Fetching Recipe:",e)):(console.error("‚ùå ERROR: No recipe specified in URL."),document.getElementById("recipe-details").innerHTML="<p>‚ö†Ô∏è No recipe found. Please go back and select a recipe.</p>")}),document.addEventListener("DOMContentLoaded",function(){let t=document.getElementById("menuBtn"),n=document.getElementById("sidebar");t.addEventListener("click",function(e){n.classList.toggle("open"),n.classList.contains("open")?t.textContent="X":t.textContent="‚ò∞",e.stopPropagation()}),document.addEventListener("click",function(e){n.contains(e.target)||t.contains(e.target)||n.classList.remove("open"),n.classList.contains("open")||(t.textContent="‚ò∞")}),n.addEventListener("click",function(e){e.stopPropagation()})});