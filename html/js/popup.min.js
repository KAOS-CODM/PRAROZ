document.addEventListener("DOMContentLoaded",function(){let i=document.getElementById("popupContainer");fetch(window.API_BASE_URL+"/api/data/popup").then(e=>e.json()).then(e=>{let t=e.popupForm;if(t){i.innerHTML=`
                <div id="popupForm" class="popup">
                    <div class="popup-content">
                        <span class="close-btn">&times;</span>
                        <h2>${t.title}</h2>
                        <p>${t.message}</p>
                        <form id="popupFormContent" action="https://formspree.io/f/${t.formspreeid}" method="POST">
                            ${t.fields.map(e=>`
                            <label for="${e.id}">${e.label}</label>
                            <input type="${e.type}" id="${e.id}" name="${e.name}" ${e.required?"required":""}>
                            `).join("")}
                            <div id="recaptcha-container">
                                <div id="g-recaptcha" class="g-recaptcha" data-sitekey="${t.recaptchaSiteKey}"></div>
                            </div>
                            <button type="submit">${t.submitText}</button>
                        </form>
                        <p id="g-recaptcha-response"></p>
                    </div>
                </div>
            `;let n=document.getElementById("popupForm");e=document.querySelector(".close-btn");let o=document.getElementById("popupFormContent");function a(){console.log("popup found"),i.classList.add("active"),n.style.display="flex",function e(t){"undefined"==typeof grecaptcha?setTimeout(()=>e(t),500):t()}(()=>{grecaptcha.render("g-recaptcha",{sitekey:t.recaptchaSiteKey})})}sessionStorage.getItem("popupShown")||setTimeout(()=>{a(),sessionStorage.setItem("popupShown","true")},5e3),e.addEventListener("click",function(){n.style.display="none"}),window.addEventListener("click",function(e){e.target===n&&(n.style.display="none")}),o.addEventListener("submit",function(e){e.preventDefault();var t,e=grecaptcha.getResponse();e?((t=new FormData(o)).append("g-recaptcha-response",e),fetch(o.action,{method:"POST",body:t,headers:{Accept:"application/json"}}).then(e=>e.json()).then(e=>{e.ok?(alert("Form Submitted Successfully!"),n.style.display="none",o.reset(),grecaptcha.reset()):alert("Error submitting form. Please try again!")}).catch(e=>{console.error("Error:",e),alert("Something went wrong. Please try again.")})):alert("Please complete the reCAPTCHA")})}}).catch(e=>console.error("Error fetching JSON:",e))}),document.addEventListener("DOMContentLoaded",function(){var e=localStorage.getItem("lastLandingTime");(!e||864e5<Date.now()-e)&&(window.location.href="landing.html")});